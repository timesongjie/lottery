<?xml version="1.0" encoding="UTF-8" ?>   
<!DOCTYPE mapper   
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="lotteryMapper">
	<!-- 中奖记录 -->
	<select id="selectLotteryRecords" resultType="lotteryRecord">
		select * from t_lottery_record order by lottery_grade,id desc limit 0,10
	</select>

	<insert id="addLotteryRecords" parameterType="lotteryRecord">
		insert into t_lottery_record(userId,lottery_date,sn,lottery_grade)
		values(#{userId},#{lottery_date},#{sn},#{lottery_grade})
	</insert>
	
	<!-- 下载记录 -->
	<select id="addLotteryDownloadRecord" parameterType="lotteryDownloadRecord" >
		insert into t_lottery_download(userId,app_id)
		values(#{userId},#{appId})
	</select>
	<select id="countUserDownloadRecord" parameterType="string" resultType="int">
		select count(*) from t_lottery_download where userId = #{userId}
	</select>
	
	<!-- 是否svip -->
	<select id="isVip" parameterType="lotteryUserInfo" resultType="int">
		select count(*) from t_lottery_users where name = #{name} or email = #{email} or phonenum = #{phonenum} 
	</select>
	
	<!-- click -->
	<select id="countClickTimesByUserId" parameterType="string" resultType="integer">
		select  count(*) from t_lottery_click where userId = #{userId} and click_date like concat(curdate(),'%')
	</select>
	<insert id="addclickRecords" parameterType="lotteryClickRecord">
		insert into t_lottery_click(userId,click_date)values(#{userId},now())
	</insert>
	
	
</mapper>